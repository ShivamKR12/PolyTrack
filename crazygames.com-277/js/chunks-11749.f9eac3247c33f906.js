try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="eb26ec98-6845-4b92-98d8-fa1090cb52a6",e._sentryDebugIdIdentifier="sentry-dbid-eb26ec98-6845-4b92-98d8-fa1090cb52a6")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:crazygames-portal":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11749],{81605:(e,t,a)=>{a.d(t,{i:()=>r});var r=function(e){return e[e.CANCEL=0]="CANCEL",e[e.POSITIVE=1]="POSITIVE",e[e.NEGATIVE=-1]="NEGATIVE",e}({})},52986:(e,t,a)=>{a.d(t,{A:()=>o});var r=a(74848),s=a(96540),n=a(89706);let o=s.memo(e=>(0,r.jsx)(n.A,{...e,viewBox:"0 0 24 24",children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.1051 3.90453C10.1051 2.84042 10.9755 2 12.0215 2H12.1183C13.7773 2 15.1446 3.33088 15.1446 5V9H18.9711C21.2014 9 22.6959 11.3321 21.6755 13.3463L18.1295 20.3463C17.6137 21.3646 16.5645 22 15.4251 22H11.3546C11.1082 22 10.8627 21.9702 10.6236 21.9112L6.93101 21H5.02628C3.36726 21 2 19.6691 2 18V12C2 10.3309 3.36726 9 5.02628 9H7.19669L9.66081 5.35177C9.95107 4.92203 10.1051 4.41848 10.1051 3.90453ZM6.05257 11H5.02628C4.44713 11 4 11.46 4 12V18C4 18.54 4.44713 19 5.02628 19H6.05257V11ZM8.05257 19.2168V11.3061L11.3182 6.47121C11.8129 5.73871 12.0857 4.88122 12.1041 4H12.1183C12.6974 4 13.1446 4.45998 13.1446 5V9H12.1183C11.566 9 11.1183 9.44772 11.1183 10C11.1183 10.5523 11.566 11 12.1183 11H18.9711C19.7534 11 20.2183 11.7971 19.8914 12.4425L16.3454 19.4425C16.1747 19.7794 15.8207 20 15.4251 20H11.3546C11.2696 20 11.185 19.9897 11.1027 19.9694L8.05257 19.2168Z"})}))},5672:(e,t,a)=>{a.d(t,{A:()=>L,S:()=>G});var r=a(74848),s=a(70111),n=a(68195),o=a(96540),i=a(59386),l=a(78766),d=a(59785),u=a(73347),c=a(79004),f=a(24747),g=a(64996),m=a(38131),p=a(77969),w=a(45300),y=a(97307);let v=e=>{let{game:t,gfSource:a}=e,{user:r,loadingUser:s}=o.useContext(i.R),{data:l}=(0,n.IT)(y.J_,{skip:!r}),[c]=(0,p._)(y.J_),[f,g]=o.useState(!1),m=o.useRef(!1),{openedDrawer:v}=o.useContext(d.l9),{favourites:b}=o.useContext(u.K),C=b.some(e=>e.slug===t.slug);return o.useEffect(()=>{v&&["signIn","signUpEmail"].includes(v.drawer)&&g(!0)},[v]),o.useEffect(()=>{f&&r&&!m.current&&(m.current=!0,async function(){let e=await c();if(!e.data){m.current=!1;return}let t=e.data.me,s={username:`${t.username}`,profilePictureUrl:`${w.A.Instance.data.images}${t.profile.avatar}`};a.window?.postMessage({type:"userLoggedIn",data:{userId:r.uid,userData:s,email:r?.email||void 0}},"*")}())},[r,a,c,f]),o.useEffect(()=>{if(s)return;let e=l?{username:`${l.me.username}`,profilePictureUrl:`${w.A.Instance.data.images}${l.me.profile.avatar}`}:void 0,t={type:"userPortalInfoSync",data:{userId:r?.uid,userData:e,isFavouriteGame:C,email:r?.email||void 0}};a.window?.postMessage(t,"*")},[C,s,r,l,a]),null};var b=a(62465);let C=e=>{let{theatreModeAvailable:t,gfSource:a}=e;return o.useEffect(()=>{t?a.window?.postMessage("set-status-theatre-mode-enabled","*"):a.window?.postMessage("set-status-theatre-mode-disabled","*")},[t,a]),null};var I=a(45249),A=a(9020),h=a(67023),E=a(66961);let S=e=>{let{gfSource:t}=e,{services:a}=o.useContext(g.A),r=a.crazyAnalyticsService,{pageUrlHelper:s}=o.useContext(E.e);return o.useEffect(()=>{(async()=>{let e=await r.analyticsInfo();s.isOnPreviewPage()&&(e.enabled=!1),t.window?.postMessage({type:"analyticsInfoGF",data:{analyticsInfo:e}},"*")})()},[r,t,s]),null};var M=a(9656),k=a(49704),x=a(53436),T=a(22018),P=a(30804);let G=null,L=e=>{let{game:t,theatreModeAvailable:a}=e,{user:p,loadingUser:w,isNewUser:E}=o.useContext(i.R),{openDrawer:L}=o.useContext(d.lv),{isDesktop:_}=o.useContext(M.A),{favourites:N,addToFavourite:D,removeFromFavourite:O}=o.useContext(u.K),{services:R}=o.useContext(g.A),{routeHelper:H}=o.useContext(I.A),{setProgressIconStatus:q,resetGameInvites:F,setGameInviteLink:U,gameInviteLink:V}=o.useContext(A.Tz),{czyDynamicPriceFloorVariantsCZY_14537:j}=o.useContext(P.H),{crazyRouterChange:z}=o.useContext(h.G),$=(0,s.m)(),{data:J}=(0,n.IT)(y.J_,{skip:!p}),B=N.some(e=>e.slug===t.slug),[K,Z]=o.useState(null),Q=R.experimentService,Y=k.QB(),W=(0,x.hO)(t.slug);return(o.useEffect(()=>{let e=async e=>{let{requestType:t,rawGraphqlString:a,variables:r,fetchPolicy:s,errorPolicy:n="all",callbackId:o}=e.data;try{let i=(0,c.qg)(a);if("query"===t){let t=await $.query({query:i,variables:r,fetchPolicy:s,errorPolicy:n}),a={resultData:t.data,errors:t.errors,networkStatus:t.networkStatus,callbackId:o};e.source?.postMessage({type:"forwardToUpGraphqlResponse",data:a},"*")}else if("mutation"===t){let t=await $.mutate({mutation:i,fetchPolicy:"no-cache",variables:r,errorPolicy:n,context:{queryDeduplication:!1}}),a={resultData:t.data,errors:t.errors,callbackId:o};e.source?.postMessage({type:"forwardToUpGraphqlResponse",data:a},"*")}}catch(a){console.error("[UPGFConnector]",JSON.stringify(a));let t={resultData:null,errors:[a.message?a.message:JSON.stringify(a)],callbackId:o};e.source?.postMessage({type:"forwardToUpGraphqlResponse",data:t},"*")}},r=e=>{let t=!!JSON.parse(m.A.Instance.getItem(f.r)||"false"),r=!!JSON.parse(m.A.Instance.getItem(f.z)||"false"),s=p?.email?.trim().toLowerCase().replace(/\+[^@]*@/g,"@"),n=function(e){if(!(0,T.O)(e))return!1;switch(e){case"portalandgameframe":case"gameframe":return!0;case"portal":case"disabled":return!1}}(j);e.source?.postMessage({type:"gfInit",data:{userAccountAvailable:!0,userExpected:t,theatreModeAvailable:a,wasUserLoggedIn:r,isNewUser:"yes"===E,email:s||void 0,useAssertiveYieldDynamicPriceFloors:n,vote:W}},"*"),Z({window:e.source}),G={window:e.source},(0,b.$n)("beforePlayNow")},s=async a=>{if(a.data&&a.data.type===l.x)switch(a.data.event){case"requestToFavouriteGame":p?D({id:t.id,slug:t.slug,name:t.slug,cover:t.cover,covers:t.covers,videos:t.videos,status:t.status,iosFriendly:!0,androidFriendly:!0,mobileFriendly:!0,gameThumbLabels:[]}):L("myGames-favourite");break;case"requestToUnFavouriteGame":p?O(t.id):L("myGames");break;case"forwardToUpGraphql":await e(a);break;case"requestGfInit":r(a);break;case"redirectToHomepage":{let e=H.homePageLink();z(e.href,e.as);break}case"refreshGamePage":window.location.reload();break;case"openProgressStatusDrawer":q(a.data.progressIconStatus),L("progressStatus");break;case"showInviteButton":if(!p)return;U(a.data.inviteUrl),R.crazyAnalyticsService.gameInteractionEvent({method:"join",origin:"game",action:"broadcast",target:null,targetStatus:null,targetGameId:t.id});break;case"hideInviteButton":if(!p||!V)return;await Y({variables:{input:{joinUrl:V,gameId:t.id}}}),F(),U(null),R.crazyAnalyticsService.gameInteractionEvent({method:"join",origin:"game",action:"expire",target:null,targetStatus:null,targetGameId:t.id});break;case"showFriendsDrawer":p?L("friends"):L("friendsGuest"),R.crazyAnalyticsService.sendModalEvent("noRewardAltCTA","open","invite_friends","noRewardAltInviteFriends");break;case"showEditProfileDrawer":L("editProfile"),R.crazyAnalyticsService.sendModalEvent("noRewardAltCTA","open","complete_profile","noRewardAltCompleteProfile");break;case"showLoginDrawer":L("signIn"),R.crazyAnalyticsService.sendModalEvent("noRewardAltCTA","open","login","noRewardAltLogin");break;case"showOnMobileDrawer":L("shareOnMobile"),R.crazyAnalyticsService.sendModalEvent("noRewardAltCTA","open","on_mobile","noRewardAltPlayOnMobile")}};return window.addEventListener("message",s),function(){window.removeEventListener("message",s)}},[z,$,R,p,a,D,O,L,t,B,J,w,H,Q,q,F,U,_,V,Y,j,W,E]),K)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(C,{gfSource:K,theatreModeAvailable:a}),(0,r.jsx)(v,{game:t,gfSource:K}),(0,r.jsx)(S,{gfSource:K})]}):null}},53436:(e,t,a)=>{a.d(t,{GG:()=>i,OC:()=>n,hO:()=>o});var r=a(81605),s=a(38131);let n=e=>`vote-${e}`,o=e=>{let t=n(e),a=s.A.Instance.getItem(t);if(!a)return r.i.CANCEL;try{let e=parseInt(a,10);switch(e){case r.i.CANCEL:case r.i.POSITIVE:case r.i.NEGATIVE:return e;default:return r.i.CANCEL}}catch{return r.i.CANCEL}},i=(e,t)=>{let a=s.A.Instance,o=n(e);t===r.i.CANCEL?a.removeItem(o):a.setItem(o,`${t}`)}}}]);